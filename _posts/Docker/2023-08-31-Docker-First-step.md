---
title: 1. 도커의 기본적인 사용법
author: maruduke
date: 2023-08-31 14:10:00 +0800
categories: [Docker]
tags: [docker]
---

## 컨테이너로 Hello World 실행하기
``` console
docker container run diamol/ch02-hello-diamol
```

docker container run 명령은 컨테이너로 애플리케이션을 실행하라는 도커 명령이다. 이 애플리케이션은 미리 도커로 실행하도록 패키징돼 누구나 내려받을 수 있도록 공유된 것이다. 이 컨테이너 패키지(도커에서는 이미지라 함)의 이름은 diamol/ch02-hello-diamol이다. 지금 입력한 명령이 이미지를 이용해 컨테이너를 실행하는 도커 명령이다.

![Desktop View](/assets/img/Docker/1-1.png)

이미지를 이용해 컨테이너를 실행하려면 먼저 이미지가 있어야한다. 조금 전 명령어를 실행한 시점에서 이미지를 갖고 있지 않았다. 그래서 도커가 이미지를 내려받는(도커에서 이미지를 내려받는 것을 pull이라고 한다.) 과정을 볼 수 있다.  

이미지를 내려받고 나면 내려받은 이미지를 사용해 컨테이너를 실행한다. 이미지에는 애플리케이션을 실행하는 데 필요한 모든 내용과 함께 애플리케이션을 실행하는 방법이 정의돼 있다.



## 컨테이너를 원격 컴퓨터처럼 사용하기


방금 전 실행했더 스크립트는 간단하게 메시지를 출력한 다음 종료되는 것이었지만, 한 스크립트 안에서 여러 도구를 사용해 필요한 일을 처리하는 경우가 있다. 이런 경우에는 대부분 특정 도구가 필요하므로 스크립트 외 도구를 함께 공유해야 한다. 이럴 경우 도구를 다시 설치하고 사용하는 방법을 담은 문서 전달 및 설치에 시간이 추가적으로 필요하다. 그러나 도커를 사용하면 하나의 이미지로 패키징하여 추가적인 설치 및 설정 작업 없이 컨테이너로 스크립트를 바로 실행하게 할 수 있다.

이번에는 컨테이너를 실행하고 실행된 컨테이너에 마치 원격 컴퓨터에 접속하듯 터미널을 통해 전달해 보겠다.
``` console
docker container run --interactive --tty diamol/base
```

![Desktop View](/assets/img/Docker/1-2.png)

해당 사진을 참고하면 원격 컴퓨터에 접속한 것과 같은 로컬 터미널 세션이 열려 있다는 것과 연결된 컴퓨터가 현재 실행 중인 컨테이너라는 것이다.


## 컨테이너 상태 체크

새로운 터미널 세션을 열고 명령어를 입력해 현재 실행 중인 모든 컨테이너에 대한 정보를 확인한다.
``` console
docker container ls
```
![Desktop View](/assets/img/Docker/1-3.png)

이 명령이를 실행하면 현재 실행중인 모든 컨테이너의 정보를 볼 수 있다. 컨테이너마다 컨테이너의 바탕이 된 이미지, 컨테이너 ID, 실행 후 도커가 실행한 명령 등이 출력된다.
  

컨테이너에서 실행 중인 프로세스가 2개 이상이라면 모든 프로세스에 대한 정보가 출력된다. 다음 명령어를 사용하여 특정 컨테이너만 가져오기 위해서 컨테이너ID 일부를 활용한 다음 명령어를 활용할 수 있다.  
``` console
docker container top 4c
```
  
docker container logs 명령은 대상 컨테이너의 수집된 로그를 출력한다.
``` console
docker container logs 4c
```

docker container inspect 명령은 대상 컨테이너의 상세한 정보를 보여준다.
``` console
docker container inspect 4c
```

## 컨테이너를 사용해 웹 사이트 호스팅하기

컨테이너에서 간단한 웹사이트를 호스팅하는 명령어는 다음과 같다.
``` console
docker container run --detach --publish 8088:80 diamol/ch02-hello-diamol-web
```

이 이미지로 컨테이너를 실행하면 실제 웹 서버를 통해 웹 페이지가 제공된다. 컨테이너가 백그라운드에서 동작하면서 네트워크를 주시(listen)하게 하려면 docker container run명령에 두 개의 플래그를 적용해야 한다.

- --detach: 컨테이너를 백그라운드에서 실행하며 컨테이너ID를 출력한다.
- --publish: 컨테이너의 포트를 호스트 컴퓨터에 공개한다.

--detach 플래그를 적용해 실행한 컨테이너는 마치 리눅스 데몬이나 윈도 서비스처럼 백그라운드로 동작하며 겉으로 드러나지 않는다.
컨테이너는 기본적으로 외부환경에 노출되지 않는다. 각 컨테이너는 고유의 IP주소를 갖지만, 이 IP주소는 도커가 관리하는 내부 가상 네트워크 주소지 호스트 컴퓨터가 연결된 물리 네트워크에 연결된 것은 아니다. 컨테이너의 포트를 공개한다는 것은 도커가 호스트 컴퓨터의 포트를 주시하다가 해당 포트로 들어오는 트래픽을 컨테이너로 전달해주는 것이다. 앞의 예제의 경우 호스트 컴퓨터의 8088번 포트로 들어온 트래픽이 컨테이너의 80번 포트로 전달된 것이다.


## 도커 메모리 사용량 확인
docker container stats 명령으로도 실행 중인 컨테이너의 상태를 확인할 수 있다. 이 명령을 실행하면 실시간으로 컨테이너의 CPU, 메모리, 네트워크, 디스크 사용량을 확인할 수 있다.  
``` console
docker container stats 4c
```